name: Install and Test

on:
  workflow_dispatch:

  push:
    branches: [ main ]
  
jobs:
  install:
    name: Install
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run install script
        run: |
          if [ "${ACT}" = "true" ]; then
            sh setup.sh
          else
            curl -sS https://raw.githubusercontent.com/OneAutumnMango/zsh-configs/main/setup.sh | sh
          fi
      
      - name: Verify Zsh
        run:
          command -v zsh >/dev/null 2>&1 && echo "zsh is installed" || exit 1

      - name: Verify Starship
        run: exec starship init zsh

      - name: Verify Zoxide
        run: |
          export PATH="$PATH:$HOME/.local/bin"
          exec zoxide init zsh

      - name: Verify Files
        run: |
          set -e
          [ ! -f ~/.zsh_aliases ]          && { echo "~/.zsh_aliases not found"; exit 1; }
          [ ! -f ~/.zsh_functions ]        && { echo "~/.zsh_functions not found"; exit 1; }
          [ ! -f ~/.zshrc ]                && { echo "~/.zshrc not found"; exit 1; }
          [ ! -f ~/.gitconfig ]            && { echo "~/.gitconfig not found"; exit 1; }
          [ ! -f ~/.config/starship.toml ] && { echo "~/.config/starship.toml not found"; exit 1; }


              
