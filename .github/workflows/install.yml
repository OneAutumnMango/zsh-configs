name: Install and Test

on:
  workflow_dispatch:

  push:
    branches: [ main ]
  
jobs:
  install:
    name: Install
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run install script
        run: |
          if [ "${ACT}" = "true" ]; then
            sh setup.sh
          else
            curl -sS https://raw.githubusercontent.com/OneAutumnMango/zsh-configs/main/setup.sh | sh
          fi
      
      - name: Verify Zsh
        run:
          command -v zsh >/dev/null 2>&1 && echo "zsh is installed" || exit 1

      - name: Verify Starship
        run: exec starship init zsh

      - name: Verify Zoxide
        run: |
          export PATH="$PATH:$HOME/.local/bin"
          exec zoxide init zsh

      - name: Verify Files
        run: |
          set -e
          echo "Checking ~/.zsh_aliases"
          [ -f ~/.zsh_aliases ]
          echo "Checking ~/.zsh_functions"
          [ -f ~/.zsh_functions ]
          echo "Checking ~/.zshrc"
          [ -f ~/.zshrc ]
          echo "Checking ~/.gitconfig"
          [ -f ~/.gitconfig ]
          echo "Checking ~/.config/starship.toml"
          [ -f ~/.config/starship.toml ]


              
